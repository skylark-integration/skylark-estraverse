{"version":3,"sources":["estraverse.js"],"names":["define","Syntax","VisitorOption","VisitorKeys","BREAK","SKIP","REMOVE","deepCopy","obj","key","val","ret","hasOwnProperty","Reference","parent","this","Element","node","path","wrap","ref","Controller","isNode","type","isProperty","nodeType","ObjectExpression","ObjectPattern","candidateExistsInLeaveList","leavelist","candidate","i","length","traverse","root","visitor","extendCommentRange","comment","tokens","target","array","func","diff","current","len","token","range","extendedRange","AssignmentExpression","AssignmentPattern","ArrayExpression","ArrayPattern","ArrowFunctionExpression","AwaitExpression","BlockStatement","BinaryExpression","BreakStatement","CallExpression","CatchClause","ChainExpression","ClassBody","ClassDeclaration","ClassExpression","ComprehensionBlock","ComprehensionExpression","ConditionalExpression","ContinueStatement","DebuggerStatement","DirectiveStatement","DoWhileStatement","EmptyStatement","ExportAllDeclaration","ExportDefaultDeclaration","ExportNamedDeclaration","ExportSpecifier","ExpressionStatement","ForStatement","ForInStatement","ForOfStatement","FunctionDeclaration","FunctionExpression","GeneratorExpression","Identifier","IfStatement","ImportExpression","ImportDeclaration","ImportDefaultSpecifier","ImportNamespaceSpecifier","ImportSpecifier","Literal","LabeledStatement","LogicalExpression","MemberExpression","MetaProperty","MethodDefinition","ModuleSpecifier","NewExpression","PrivateIdentifier","Program","Property","PropertyDefinition","RestElement","ReturnStatement","SequenceExpression","SpreadElement","Super","SwitchStatement","SwitchCase","TaggedTemplateExpression","TemplateElement","TemplateLiteral","ThisExpression","ThrowStatement","TryStatement","UnaryExpression","UpdateExpression","VariableDeclaration","VariableDeclarator","WhileStatement","WithStatement","YieldExpression","Break","Skip","Remove","prototype","replace","remove","Array","isArray","splice","iz","j","jz","result","addToPath","push","__current","__leavelist","parents","__execute","callback","element","undefined","previous","__state","call","notify","flag","skip","__initialize","__worklist","__fallback","fallback","Object","keys","__keys","assign","create","worklist","current2","candidates","sentinel","pop","leave","enter","Error","outer","removeElem","nextElem","traversals","attachComments","tree","providedComments","cursor","comments","leadingComments","trailingComments"],"mappings":"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","file":"../estraverse.js","sourcesContent":["/*\n  Copyright (C) 2012-2013 Yusuke Suzuki <utatane.tea@gmail.com>\n  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>\n\n  Redistribution and use in source and binary forms, with or without\n  modification, are permitted provided that the following conditions are met:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n    * Redistributions in binary form must reproduce the above copyright\n      notice, this list of conditions and the following disclaimer in the\n      documentation and/or other materials provided with the distribution.\n\n  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY\n  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n/*jslint vars:false, bitwise:true*/\n/*jshint indent:4*/\n/*global exports:true*/\ndefine([],function(){\n    'use strict';\n\n    var Syntax,\n        VisitorOption,\n        VisitorKeys,\n        BREAK,\n        SKIP,\n        REMOVE;\n\n    function deepCopy(obj) {\n        var ret = {}, key, val;\n        for (key in obj) {\n            if (obj.hasOwnProperty(key)) {\n                val = obj[key];\n                if (typeof val === 'object' && val !== null) {\n                    ret[key] = deepCopy(val);\n                } else {\n                    ret[key] = val;\n                }\n            }\n        }\n        return ret;\n    }\n\n    // based on LLVM libc++ upper_bound / lower_bound\n    // MIT License\n\n    function upperBound(array, func) {\n        var diff, len, i, current;\n\n        len = array.length;\n        i = 0;\n\n        while (len) {\n            diff = len >>> 1;\n            current = i + diff;\n            if (func(array[current])) {\n                len = diff;\n            } else {\n                i = current + 1;\n                len -= diff + 1;\n            }\n        }\n        return i;\n    }\n\n    Syntax = {\n        AssignmentExpression: 'AssignmentExpression',\n        AssignmentPattern: 'AssignmentPattern',\n        ArrayExpression: 'ArrayExpression',\n        ArrayPattern: 'ArrayPattern',\n        ArrowFunctionExpression: 'ArrowFunctionExpression',\n        AwaitExpression: 'AwaitExpression', // CAUTION: It's deferred to ES7.\n        BlockStatement: 'BlockStatement',\n        BinaryExpression: 'BinaryExpression',\n        BreakStatement: 'BreakStatement',\n        CallExpression: 'CallExpression',\n        CatchClause: 'CatchClause',\n        ChainExpression: 'ChainExpression',\n        ClassBody: 'ClassBody',\n        ClassDeclaration: 'ClassDeclaration',\n        ClassExpression: 'ClassExpression',\n        ComprehensionBlock: 'ComprehensionBlock',  // CAUTION: It's deferred to ES7.\n        ComprehensionExpression: 'ComprehensionExpression',  // CAUTION: It's deferred to ES7.\n        ConditionalExpression: 'ConditionalExpression',\n        ContinueStatement: 'ContinueStatement',\n        DebuggerStatement: 'DebuggerStatement',\n        DirectiveStatement: 'DirectiveStatement',\n        DoWhileStatement: 'DoWhileStatement',\n        EmptyStatement: 'EmptyStatement',\n        ExportAllDeclaration: 'ExportAllDeclaration',\n        ExportDefaultDeclaration: 'ExportDefaultDeclaration',\n        ExportNamedDeclaration: 'ExportNamedDeclaration',\n        ExportSpecifier: 'ExportSpecifier',\n        ExpressionStatement: 'ExpressionStatement',\n        ForStatement: 'ForStatement',\n        ForInStatement: 'ForInStatement',\n        ForOfStatement: 'ForOfStatement',\n        FunctionDeclaration: 'FunctionDeclaration',\n        FunctionExpression: 'FunctionExpression',\n        GeneratorExpression: 'GeneratorExpression',  // CAUTION: It's deferred to ES7.\n        Identifier: 'Identifier',\n        IfStatement: 'IfStatement',\n        ImportExpression: 'ImportExpression',\n        ImportDeclaration: 'ImportDeclaration',\n        ImportDefaultSpecifier: 'ImportDefaultSpecifier',\n        ImportNamespaceSpecifier: 'ImportNamespaceSpecifier',\n        ImportSpecifier: 'ImportSpecifier',\n        Literal: 'Literal',\n        LabeledStatement: 'LabeledStatement',\n        LogicalExpression: 'LogicalExpression',\n        MemberExpression: 'MemberExpression',\n        MetaProperty: 'MetaProperty',\n        MethodDefinition: 'MethodDefinition',\n        ModuleSpecifier: 'ModuleSpecifier',\n        NewExpression: 'NewExpression',\n        ObjectExpression: 'ObjectExpression',\n        ObjectPattern: 'ObjectPattern',\n        PrivateIdentifier: 'PrivateIdentifier',\n        Program: 'Program',\n        Property: 'Property',\n        PropertyDefinition: 'PropertyDefinition',\n        RestElement: 'RestElement',\n        ReturnStatement: 'ReturnStatement',\n        SequenceExpression: 'SequenceExpression',\n        SpreadElement: 'SpreadElement',\n        Super: 'Super',\n        SwitchStatement: 'SwitchStatement',\n        SwitchCase: 'SwitchCase',\n        TaggedTemplateExpression: 'TaggedTemplateExpression',\n        TemplateElement: 'TemplateElement',\n        TemplateLiteral: 'TemplateLiteral',\n        ThisExpression: 'ThisExpression',\n        ThrowStatement: 'ThrowStatement',\n        TryStatement: 'TryStatement',\n        UnaryExpression: 'UnaryExpression',\n        UpdateExpression: 'UpdateExpression',\n        VariableDeclaration: 'VariableDeclaration',\n        VariableDeclarator: 'VariableDeclarator',\n        WhileStatement: 'WhileStatement',\n        WithStatement: 'WithStatement',\n        YieldExpression: 'YieldExpression'\n    };\n\n    VisitorKeys = {\n        AssignmentExpression: ['left', 'right'],\n        AssignmentPattern: ['left', 'right'],\n        ArrayExpression: ['elements'],\n        ArrayPattern: ['elements'],\n        ArrowFunctionExpression: ['params', 'body'],\n        AwaitExpression: ['argument'], // CAUTION: It's deferred to ES7.\n        BlockStatement: ['body'],\n        BinaryExpression: ['left', 'right'],\n        BreakStatement: ['label'],\n        CallExpression: ['callee', 'arguments'],\n        CatchClause: ['param', 'body'],\n        ChainExpression: ['expression'],\n        ClassBody: ['body'],\n        ClassDeclaration: ['id', 'superClass', 'body'],\n        ClassExpression: ['id', 'superClass', 'body'],\n        ComprehensionBlock: ['left', 'right'],  // CAUTION: It's deferred to ES7.\n        ComprehensionExpression: ['blocks', 'filter', 'body'],  // CAUTION: It's deferred to ES7.\n        ConditionalExpression: ['test', 'consequent', 'alternate'],\n        ContinueStatement: ['label'],\n        DebuggerStatement: [],\n        DirectiveStatement: [],\n        DoWhileStatement: ['body', 'test'],\n        EmptyStatement: [],\n        ExportAllDeclaration: ['source'],\n        ExportDefaultDeclaration: ['declaration'],\n        ExportNamedDeclaration: ['declaration', 'specifiers', 'source'],\n        ExportSpecifier: ['exported', 'local'],\n        ExpressionStatement: ['expression'],\n        ForStatement: ['init', 'test', 'update', 'body'],\n        ForInStatement: ['left', 'right', 'body'],\n        ForOfStatement: ['left', 'right', 'body'],\n        FunctionDeclaration: ['id', 'params', 'body'],\n        FunctionExpression: ['id', 'params', 'body'],\n        GeneratorExpression: ['blocks', 'filter', 'body'],  // CAUTION: It's deferred to ES7.\n        Identifier: [],\n        IfStatement: ['test', 'consequent', 'alternate'],\n        ImportExpression: ['source'],\n        ImportDeclaration: ['specifiers', 'source'],\n        ImportDefaultSpecifier: ['local'],\n        ImportNamespaceSpecifier: ['local'],\n        ImportSpecifier: ['imported', 'local'],\n        Literal: [],\n        LabeledStatement: ['label', 'body'],\n        LogicalExpression: ['left', 'right'],\n        MemberExpression: ['object', 'property'],\n        MetaProperty: ['meta', 'property'],\n        MethodDefinition: ['key', 'value'],\n        ModuleSpecifier: [],\n        NewExpression: ['callee', 'arguments'],\n        ObjectExpression: ['properties'],\n        ObjectPattern: ['properties'],\n        PrivateIdentifier: [],\n        Program: ['body'],\n        Property: ['key', 'value'],\n        PropertyDefinition: ['key', 'value'],\n        RestElement: [ 'argument' ],\n        ReturnStatement: ['argument'],\n        SequenceExpression: ['expressions'],\n        SpreadElement: ['argument'],\n        Super: [],\n        SwitchStatement: ['discriminant', 'cases'],\n        SwitchCase: ['test', 'consequent'],\n        TaggedTemplateExpression: ['tag', 'quasi'],\n        TemplateElement: [],\n        TemplateLiteral: ['quasis', 'expressions'],\n        ThisExpression: [],\n        ThrowStatement: ['argument'],\n        TryStatement: ['block', 'handler', 'finalizer'],\n        UnaryExpression: ['argument'],\n        UpdateExpression: ['argument'],\n        VariableDeclaration: ['declarations'],\n        VariableDeclarator: ['id', 'init'],\n        WhileStatement: ['test', 'body'],\n        WithStatement: ['object', 'body'],\n        YieldExpression: ['argument']\n    };\n\n    // unique id\n    BREAK = {};\n    SKIP = {};\n    REMOVE = {};\n\n    VisitorOption = {\n        Break: BREAK,\n        Skip: SKIP,\n        Remove: REMOVE\n    };\n\n    function Reference(parent, key) {\n        this.parent = parent;\n        this.key = key;\n    }\n\n    Reference.prototype.replace = function replace(node) {\n        this.parent[this.key] = node;\n    };\n\n    Reference.prototype.remove = function remove() {\n        if (Array.isArray(this.parent)) {\n            this.parent.splice(this.key, 1);\n            return true;\n        } else {\n            this.replace(null);\n            return false;\n        }\n    };\n\n    function Element(node, path, wrap, ref) {\n        this.node = node;\n        this.path = path;\n        this.wrap = wrap;\n        this.ref = ref;\n    }\n\n    function Controller() { }\n\n    // API:\n    // return property path array from root to current node\n    Controller.prototype.path = function path() {\n        var i, iz, j, jz, result, element;\n\n        function addToPath(result, path) {\n            if (Array.isArray(path)) {\n                for (j = 0, jz = path.length; j < jz; ++j) {\n                    result.push(path[j]);\n                }\n            } else {\n                result.push(path);\n            }\n        }\n\n        // root node\n        if (!this.__current.path) {\n            return null;\n        }\n\n        // first node is sentinel, second node is root element\n        result = [];\n        for (i = 2, iz = this.__leavelist.length; i < iz; ++i) {\n            element = this.__leavelist[i];\n            addToPath(result, element.path);\n        }\n        addToPath(result, this.__current.path);\n        return result;\n    };\n\n    // API:\n    // return type of current node\n    Controller.prototype.type = function () {\n        var node = this.current();\n        return node.type || this.__current.wrap;\n    };\n\n    // API:\n    // return array of parent elements\n    Controller.prototype.parents = function parents() {\n        var i, iz, result;\n\n        // first node is sentinel\n        result = [];\n        for (i = 1, iz = this.__leavelist.length; i < iz; ++i) {\n            result.push(this.__leavelist[i].node);\n        }\n\n        return result;\n    };\n\n    // API:\n    // return current node\n    Controller.prototype.current = function current() {\n        return this.__current.node;\n    };\n\n    Controller.prototype.__execute = function __execute(callback, element) {\n        var previous, result;\n\n        result = undefined;\n\n        previous  = this.__current;\n        this.__current = element;\n        this.__state = null;\n        if (callback) {\n            result = callback.call(this, element.node, this.__leavelist[this.__leavelist.length - 1].node);\n        }\n        this.__current = previous;\n\n        return result;\n    };\n\n    // API:\n    // notify control skip / break\n    Controller.prototype.notify = function notify(flag) {\n        this.__state = flag;\n    };\n\n    // API:\n    // skip child nodes of current node\n    Controller.prototype.skip = function () {\n        this.notify(SKIP);\n    };\n\n    // API:\n    // break traversals\n    Controller.prototype['break'] = function () {\n        this.notify(BREAK);\n    };\n\n    // API:\n    // remove node\n    Controller.prototype.remove = function () {\n        this.notify(REMOVE);\n    };\n\n    Controller.prototype.__initialize = function(root, visitor) {\n        this.visitor = visitor;\n        this.root = root;\n        this.__worklist = [];\n        this.__leavelist = [];\n        this.__current = null;\n        this.__state = null;\n        this.__fallback = null;\n        if (visitor.fallback === 'iteration') {\n            this.__fallback = Object.keys;\n        } else if (typeof visitor.fallback === 'function') {\n            this.__fallback = visitor.fallback;\n        }\n\n        this.__keys = VisitorKeys;\n        if (visitor.keys) {\n            this.__keys = Object.assign(Object.create(this.__keys), visitor.keys);\n        }\n    };\n\n    function isNode(node) {\n        if (node == null) {\n            return false;\n        }\n        return typeof node === 'object' && typeof node.type === 'string';\n    }\n\n    function isProperty(nodeType, key) {\n        return (nodeType === Syntax.ObjectExpression || nodeType === Syntax.ObjectPattern) && 'properties' === key;\n    }\n  \n    function candidateExistsInLeaveList(leavelist, candidate) {\n        for (var i = leavelist.length - 1; i >= 0; --i) {\n            if (leavelist[i].node === candidate) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    Controller.prototype.traverse = function traverse(root, visitor) {\n        var worklist,\n            leavelist,\n            element,\n            node,\n            nodeType,\n            ret,\n            key,\n            current,\n            current2,\n            candidates,\n            candidate,\n            sentinel;\n\n        this.__initialize(root, visitor);\n\n        sentinel = {};\n\n        // reference\n        worklist = this.__worklist;\n        leavelist = this.__leavelist;\n\n        // initialize\n        worklist.push(new Element(root, null, null, null));\n        leavelist.push(new Element(null, null, null, null));\n\n        while (worklist.length) {\n            element = worklist.pop();\n\n            if (element === sentinel) {\n                element = leavelist.pop();\n\n                ret = this.__execute(visitor.leave, element);\n\n                if (this.__state === BREAK || ret === BREAK) {\n                    return;\n                }\n                continue;\n            }\n\n            if (element.node) {\n\n                ret = this.__execute(visitor.enter, element);\n\n                if (this.__state === BREAK || ret === BREAK) {\n                    return;\n                }\n\n                worklist.push(sentinel);\n                leavelist.push(element);\n\n                if (this.__state === SKIP || ret === SKIP) {\n                    continue;\n                }\n\n                node = element.node;\n                nodeType = node.type || element.wrap;\n                candidates = this.__keys[nodeType];\n                if (!candidates) {\n                    if (this.__fallback) {\n                        candidates = this.__fallback(node);\n                    } else {\n                        throw new Error('Unknown node type ' + nodeType + '.');\n                    }\n                }\n\n                current = candidates.length;\n                while ((current -= 1) >= 0) {\n                    key = candidates[current];\n                    candidate = node[key];\n                    if (!candidate) {\n                        continue;\n                    }\n\n                    if (Array.isArray(candidate)) {\n                        current2 = candidate.length;\n                        while ((current2 -= 1) >= 0) {\n                            if (!candidate[current2]) {\n                                continue;\n                            }\n\n                            if (candidateExistsInLeaveList(leavelist, candidate[current2])) {\n                              continue;\n                            }\n\n                            if (isProperty(nodeType, candidates[current])) {\n                                element = new Element(candidate[current2], [key, current2], 'Property', null);\n                            } else if (isNode(candidate[current2])) {\n                                element = new Element(candidate[current2], [key, current2], null, null);\n                            } else {\n                                continue;\n                            }\n                            worklist.push(element);\n                        }\n                    } else if (isNode(candidate)) {\n                        if (candidateExistsInLeaveList(leavelist, candidate)) {\n                          continue;\n                        }\n\n                        worklist.push(new Element(candidate, key, null, null));\n                    }\n                }\n            }\n        }\n    };\n\n    Controller.prototype.replace = function replace(root, visitor) {\n        var worklist,\n            leavelist,\n            node,\n            nodeType,\n            target,\n            element,\n            current,\n            current2,\n            candidates,\n            candidate,\n            sentinel,\n            outer,\n            key;\n\n        function removeElem(element) {\n            var i,\n                key,\n                nextElem,\n                parent;\n\n            if (element.ref.remove()) {\n                // When the reference is an element of an array.\n                key = element.ref.key;\n                parent = element.ref.parent;\n\n                // If removed from array, then decrease following items' keys.\n                i = worklist.length;\n                while (i--) {\n                    nextElem = worklist[i];\n                    if (nextElem.ref && nextElem.ref.parent === parent) {\n                        if  (nextElem.ref.key < key) {\n                            break;\n                        }\n                        --nextElem.ref.key;\n                    }\n                }\n            }\n        }\n\n        this.__initialize(root, visitor);\n\n        sentinel = {};\n\n        // reference\n        worklist = this.__worklist;\n        leavelist = this.__leavelist;\n\n        // initialize\n        outer = {\n            root: root\n        };\n        element = new Element(root, null, null, new Reference(outer, 'root'));\n        worklist.push(element);\n        leavelist.push(element);\n\n        while (worklist.length) {\n            element = worklist.pop();\n\n            if (element === sentinel) {\n                element = leavelist.pop();\n\n                target = this.__execute(visitor.leave, element);\n\n                // node may be replaced with null,\n                // so distinguish between undefined and null in this place\n                if (target !== undefined && target !== BREAK && target !== SKIP && target !== REMOVE) {\n                    // replace\n                    element.ref.replace(target);\n                }\n\n                if (this.__state === REMOVE || target === REMOVE) {\n                    removeElem(element);\n                }\n\n                if (this.__state === BREAK || target === BREAK) {\n                    return outer.root;\n                }\n                continue;\n            }\n\n            target = this.__execute(visitor.enter, element);\n\n            // node may be replaced with null,\n            // so distinguish between undefined and null in this place\n            if (target !== undefined && target !== BREAK && target !== SKIP && target !== REMOVE) {\n                // replace\n                element.ref.replace(target);\n                element.node = target;\n            }\n\n            if (this.__state === REMOVE || target === REMOVE) {\n                removeElem(element);\n                element.node = null;\n            }\n\n            if (this.__state === BREAK || target === BREAK) {\n                return outer.root;\n            }\n\n            // node may be null\n            node = element.node;\n            if (!node) {\n                continue;\n            }\n\n            worklist.push(sentinel);\n            leavelist.push(element);\n\n            if (this.__state === SKIP || target === SKIP) {\n                continue;\n            }\n\n            nodeType = node.type || element.wrap;\n            candidates = this.__keys[nodeType];\n            if (!candidates) {\n                if (this.__fallback) {\n                    candidates = this.__fallback(node);\n                } else {\n                    throw new Error('Unknown node type ' + nodeType + '.');\n                }\n            }\n\n            current = candidates.length;\n            while ((current -= 1) >= 0) {\n                key = candidates[current];\n                candidate = node[key];\n                if (!candidate) {\n                    continue;\n                }\n\n                if (Array.isArray(candidate)) {\n                    current2 = candidate.length;\n                    while ((current2 -= 1) >= 0) {\n                        if (!candidate[current2]) {\n                            continue;\n                        }\n                        if (isProperty(nodeType, candidates[current])) {\n                            element = new Element(candidate[current2], [key, current2], 'Property', new Reference(candidate, current2));\n                        } else if (isNode(candidate[current2])) {\n                            element = new Element(candidate[current2], [key, current2], null, new Reference(candidate, current2));\n                        } else {\n                            continue;\n                        }\n                        worklist.push(element);\n                    }\n                } else if (isNode(candidate)) {\n                    worklist.push(new Element(candidate, key, null, new Reference(node, key)));\n                }\n            }\n        }\n\n        return outer.root;\n    };\n\n    function traverse(root, visitor) {\n        var controller = new Controller();\n        return controller.traverse(root, visitor);\n    }\n\n    function replace(root, visitor) {\n        var controller = new Controller();\n        return controller.replace(root, visitor);\n    }\n\n    function extendCommentRange(comment, tokens) {\n        var target;\n\n        target = upperBound(tokens, function search(token) {\n            return token.range[0] > comment.range[0];\n        });\n\n        comment.extendedRange = [comment.range[0], comment.range[1]];\n\n        if (target !== tokens.length) {\n            comment.extendedRange[1] = tokens[target].range[0];\n        }\n\n        target -= 1;\n        if (target >= 0) {\n            comment.extendedRange[0] = tokens[target].range[1];\n        }\n\n        return comment;\n    }\n\n    function attachComments(tree, providedComments, tokens) {\n        // At first, we should calculate extended comment ranges.\n        var comments = [], comment, len, i, cursor;\n\n        if (!tree.range) {\n            throw new Error('attachComments needs range information');\n        }\n\n        // tokens array is empty, we attach comments to tree as 'leadingComments'\n        if (!tokens.length) {\n            if (providedComments.length) {\n                for (i = 0, len = providedComments.length; i < len; i += 1) {\n                    comment = deepCopy(providedComments[i]);\n                    comment.extendedRange = [0, tree.range[0]];\n                    comments.push(comment);\n                }\n                tree.leadingComments = comments;\n            }\n            return tree;\n        }\n\n        for (i = 0, len = providedComments.length; i < len; i += 1) {\n            comments.push(extendCommentRange(deepCopy(providedComments[i]), tokens));\n        }\n\n        // This is based on John Freeman's implementation.\n        cursor = 0;\n        traverse(tree, {\n            enter: function (node) {\n                if (!node.range) {\n                    return;\n                }\n                var comment;\n\n                while (cursor < comments.length) {\n                    comment = comments[cursor];\n                    if (comment.extendedRange[1] > node.range[0]) {\n                        break;\n                    }\n\n                    if (comment.extendedRange[1] === node.range[0]) {\n                        if (!node.leadingComments) {\n                            node.leadingComments = [];\n                        }\n                        node.leadingComments.push(comment);\n                        comments.splice(cursor, 1);\n                    } else {\n                        cursor += 1;\n                    }\n                }\n\n                // already out of owned node\n                if (cursor === comments.length) {\n                    return VisitorOption.Break;\n                }\n\n                if (comments[cursor].extendedRange[0] > node.range[1]) {\n                    return VisitorOption.Skip;\n                }\n            }\n        });\n\n        cursor = 0;\n        traverse(tree, {\n            leave: function (node) {\n                if (!node.range) {\n                    return;\n                }\n                var comment;\n\n                while (cursor < comments.length) {\n                    comment = comments[cursor];\n                    if (node.range[1] < comment.extendedRange[0]) {\n                        break;\n                    }\n\n                    if (node.range[1] === comment.extendedRange[0]) {\n                        if (!node.trailingComments) {\n                            node.trailingComments = [];\n                        }\n                        node.trailingComments.push(comment);\n                        comments.splice(cursor, 1);\n                    } else {\n                        cursor += 1;\n                    }\n                }\n\n                // already out of owned node\n                if (cursor === comments.length) {\n                    return VisitorOption.Break;\n                }\n\n                if (comments[cursor].extendedRange[0] > node.range[1]) {\n                    return VisitorOption.Skip;\n                }\n            }\n        });\n\n        return tree;\n    }\n\n\n    ///exports.cloneEnvironment = function () { return clone({}); };\n\n    return {\n        Syntax,\n        traversals,\n        replace,\n        attachComments,\n        VisitorKeys,\n        Controller\n    };\n});\n/* vim: set sw=4 ts=4 et tw=80 : */\n"]}